module.exports=function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=10)}([function(e,n,t){"use strict";var o=t(1),r=t.n(o);t(12).config();const s=r.a.object().keys({NODE_ENV:r.a.string().default("development").allow(["development","production"]),PORT:r.a.number().default(8080),MYSQL_PORT:r.a.number().default(3306),MYSQL_HOST:r.a.string(),MYSQL_USER:r.a.string(),MYSQL_PASS:r.a.string(),MYSQL_NAME:r.a.string(),VERSION:r.a.string()}).unknown().required(),{error:i,value:a}=r.a.validate(process.env,s);if(i)throw new Error("Config validation error: "+i.message);const u={version:a.VERSION,env:a.NODE_ENV,port:a.PORT,mysqlPort:a.MYSQL_PORT,mysqlHost:a.MYSQL_HOST,mysqlUserName:a.MYSQL_USER,mysqlPass:a.MYSQL_PASS,mysqlDatabase:a.MYSQL_DATABASE};n.a=u},function(e,n){e.exports=require("joi")},function(e,n){e.exports=require("express")},function(e,n){e.exports=require("mysql")},function(e,n){e.exports=require("body-parser")},function(e,n,t){"use strict";var o=t(2),r=t.n(o),s=t(0),i=t(3),a=t.n(i);const u=t(6).MongoClient;var c=e=>new Promise((n,t)=>{u.connect("mongodb://35.241.103.219:27017/MyDb",(function(o,r){o&&t(o);var s,i,a=r.db("MyDb");e.WalletID=e.BankID+"-"+function e(n,t){return(n=""+n).length>=t?n:e("0"+n,t)}((s=1,i=999999999999999,Math.floor(Math.random()*(i-s+1))+s),16),delete e.BankID,a.collection("wallet",(function(o,r){r.insert(e),r.count((function(e,o){e&&t(e),console.log("Total Rows:"+o),n({"Total Rows":o})}))})),r.close()}))}),l=()=>new Promise((e,n)=>{u.connect("mongodb://35.241.103.219:27017/MyDb",(function(t,o){t&&n(t),o.db("MyDb").collection("wallet").find({}).toArray((function(r,s){if(r)throw n(t);e(s),o.close()}))}))});var f=t(7),d=[];var p=(e,n)=>{e.setEncoding("utf-8");var t="";e.addListener("data",(function(e){t+=e})),e.addListener("end",(function(){d="application/json"==e.headers["content-type"]?JSON.parse(t):f.parse(t),console.log(d.walletType)})),c(d).then(e=>{n.send(JSON.stringify(e))}).catch(e=>n.send(e))},b=(e,n)=>{l().then(e=>{n.send(JSON.stringify(e))}).catch(e=>n.send(e))};const g=r.a.Router();g.route("/").get(b).post(p);var y=g,m=t(1);const v=t(6).MongoClient;function O(e,n){return Math.floor(Math.random()*(n-e+1))+e}function S(e,n){return(e=""+e).length>=n?e:S("0"+e,n)}var M=e=>new Promise((n,t)=>{v.connect("mongodb://35.241.103.219:27017/MyDb",(function(o,r){o&&t(o),issueObj=new m.object,issueObj.Amount=e.Amount,issueObj.utxoID=S(O(1,999999999999999),16),issueObj.owner=e.walletID,issueObj.transfer="",issueObj.cc="",issueLog=new m.object,issueLog.owner=e.walletID,issueLog.Amount=e.Amount,issueLog.utxoID=S(O(1,999999999999999),16);var s=r.db("MyDb");s.collection("issue",(function(e,o){o.insert(issueObj),o.count((function(e,o){e&&t(e),n({issueToken:utxoID,issueAmount:Amount})}))})),s.collection("issueLog",(function(e,n){n.insert(issueLog),n.count((function(e,n){e&&t(e)}))})),r.close()}))}),w=e=>new Promise((n,t)=>{v.connect("mongodb://35.241.103.219:27017/MyDb",(function(o,r){o&&t(o),r.db("MyDb").collection("issueLog").find({walletID:e}).toArray((function(e,s){if(e)throw t(o);n(s),r.close()}))}))}),h=t(7),j=[];var P=(e,n)=>{j=function(e){e.setEncoding("utf-8");var n="";e.addListener("data",(function(e){n+=e})),e.addListener("end",(function(){return j="application/json"==e.headers["content-type"]?JSON.parse(n):h.parse(n),console.log(j.issueType),j}))}(e),M(j).then(e=>{n.send(JSON.stringify(e))}).catch(e=>n.send(e))},D=(e,n)=>{w(e.params.walletID).then(e=>{n.send(JSON.stringify(e))}).catch(e=>n.send(e))};const q=r.a.Router();q.route("/").get(D).post(P);t(13);const x=r.a.Router();x.use("/wallet",y),x.get("/",(e,n)=>{n.send(`此路徑是: localhost:${s.a.port}/api`)}),x.get("/sqlTest",(e,n)=>{a.a.createPool({connectionLimit:"10",host:s.a.mysqlHost,user:s.a.mysqlUserName,password:s.a.mysqlPass,database:s.a.mysqlDatabase}).getConnection((e,t)=>{e?(n.send(e),console.log("連線失敗！")):(n.send("連線成功！"),console.log(t))})});var L=x,_=t(4),N=t.n(_),T=t(8),A=t.n(T),E=t(9),R=t.n(E);const I=r()();I.get("/",(e,n)=>{n.send(`server started on  port http://127.0.0.1:${s.a.port} (${s.a.env})`)}),I.use("/api",L),I.use(N.a.json()),I.use(N.a.urlencoded({extended:!0})),I.use(A()()),I.use(R()("dev"));n.a=I},function(e,n){e.exports=require("mongodb")},function(e,n){e.exports=require("querystring")},function(e,n){e.exports=require("cors")},function(e,n){e.exports=require("morgan")},function(e,n,t){"use strict";t.r(n),function(e){var o=t(0),r=t(5);e.parent||r.a.listen(o.a.port,()=>{console.log(`server started on  port http://127.0.0.1:${o.a.port} (${o.a.env})`)}),n.default=r.a}.call(this,t(11)(e))},function(e,n){e.exports=function(e){if(!e.webpackPolyfill){var n=Object.create(e);n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),Object.defineProperty(n,"exports",{enumerable:!0}),n.webpackPolyfill=1}return n}},function(e,n){e.exports=require("dotenv")},function(e,n){}]);